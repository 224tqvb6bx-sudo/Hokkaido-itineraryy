<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>北海道冬季7天自駕遊｜互動行程表</title>
    <!-- Google Fonts：精緻優雅字體 -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lora:wght@400;500&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <!-- SortableJS -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        body { 
            margin: 0; padding: 0; font-family: 'Lora', serif; background: #fffff0; color: #333; 
        }
        header { 
            background: linear-gradient(to bottom, #a3c1e0, #fffff0); padding: 40px; text-align: center; 
            color: #333; box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        }
        h1 { font-family: 'Playfair Display', serif; font-size: 3rem; color: #d4af37; }
        h2 { font-family: 'Playfair Display', serif; color: #d4af37; }
        .container { display: flex; flex-wrap: wrap; padding: 20px; gap: 20px; max-width: 1400px; margin: auto; }
        .itinerary { flex: 1; min-width: 300px; }
        .day-card { 
            background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; 
            box-shadow: 0 4px 15px rgba(163,193,224,0.2); transition: all 0.3s ease; cursor: pointer; 
        }
        .day-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(212,175,55,0.2); }
        .day-card h3 { margin: 0; color: #d4af37; }
        details { margin-top: 15px; background: #f8f8f8; padding: 15px; border-radius: 8px; }
        summary { cursor: pointer; font-weight: bold; color: #d4af37; }
        .accommodation { font-weight: bold; color: #a3c1e0; margin-top: 10px; }
        .restaurant { margin-top: 8px; font-style: italic; color: #666; }
        .map-section { flex: 2; min-width: 300px; height: 600px; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        #map { height: 100%; }
        .budget { margin-top: 40px; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(163,193,224,0.2); }
        input { padding: 8px; width: 100px; border: 1px solid #a3c1e0; border-radius: 6px; }
        .restaurant-link { color: #d4af37; text-decoration: underline; }
        .note { font-size: 0.9rem; color: #666; }
    </style>
</head>
<body>
    <header>
        <h1>北海道冬季7天自駕遊</h1>
        <p style="font-size:1.3rem;">2026年1月｜11人團體｜滑雪、雪景與美食的優雅之旅</p>
    </header>

    <div class="container">
        <div class="itinerary">
            <h2>互動行程表（拖拽調整順序，點擊展開詳細）</h2>
            <div id="days-list">
                <!-- Day 1 -->
                <div class="day-card" data-lat="42.7944" data-lng="141.6819">
                    <h3>Day 1｜1月10日 抵達 & 前往富良野</h3>
                    <p>分批抵達新千歲機場 → 租車 → 晚間抵達富良野</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>15:50：9人抵達CTS</li>
                            <li>17:50：接餘下2人</li>
                            <li>20:00後：出發中富良野（夜路預留4小時）</li>
                            <li>23:30左右：抵達休息</li>
                            <li>晚餐：機場或路邊便利店</li>
                        </ul>
                        <p class="accommodation">住宿：中富良野 Airbnb<br>〒076-0024 北海道富良野市幸町４−31</p>
                    </details>
                </div>

                <!-- Day 2 -->
                <div class="day-card" data-lat="43.0583" data-lng="142.6333">
                    <h3>Day 2｜1月11日 星野Tomamu 全團滑雪 & 冰之村</h3>
                    <p>全天滑雪 + 晚上冰之村燈光</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>08:30-09:30：Airbnb → Tomamu（1小時）</li>
                            <li>09:30-16:30：全團滑雪 / 度假村活動</li>
                            <li>17:00-21:00：冰之村燈光（玩至20:30）</li>
                            <li>21:30-22:30：返回Airbnb</li>
                            <li>晚餐：森林餐廳或度假村內</li>
                        </ul>
                        <p class="accommodation">住宿：中富良野 Airbnb<br>〒076-0024 北海道富良野市幸町４−31</p>
                    </details>
                </div>

                <!-- Day 3 -->
                <div class="day-card" data-lat="43.4928" data-lng="142.6072">
                    <h3>Day 3｜1月12日 美瑛雪景 & 前往二世谷</h3>
                    <p>白天美瑛經典雪景 → 移動至二世谷</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>07:00-08:00：早餐，check out</li>
                            <li>08:00-14:00：美瑛地區<br>• 聖誕樹（Christmas Tree）<br>• Patchwork Road 雪原<br>• Birke之森<br>• 青池 & 白鬚瀑布（冬季雪景）</li>
                            <li>14:00-19:00：美瑛 → 二世谷（預留5小時）</li>
                            <li>19:00後：check-in 休息</li>
                            <li>晚餐：Family Mart</li>
                        </ul>
                        <p class="accommodation">住宿：二世谷<br>24-2 Kabayama Kutchan-cho, 俱知安, 044-0078, 日本</p>
                    </details>
                </div>

                <!-- Day 4 -->
                <div class="day-card" data-lat="42.8611" data-lng="140.6989">
                    <h3>Day 4｜1月13日 二世谷滑雪</h3>
                    <p>Niseko United 粉雪滑雪 + 放鬆</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>09:00-16:00：滑雪組 Niseko United 滑雪</li>
                            <li>非滑雪組：溫泉、雪鞋漫步、逛 Hirafu 村</li>
                            <li>下午/晚上：全團自由（溫泉或散步）</li>
                        </ul>
                        <p class="accommodation">住宿：二世谷<br>24-2 Kabayama Kutchan-cho, 俱知安, 044-0078, 日本</p>
                    </details>
                </div>

                <!-- Day 5 -->
                <div class="day-card" data-lat="42.8611" data-lng="140.6989">
                    <h3>Day 5｜1月14日 二世谷滑雪 & 放鬆</h3>
                    <p>繼續粉雪滑雪 + 溫泉</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>09:00-16:00：同 Day 4 滑雪活動</li>
                            <li>19:30：Icaro 餐廳晚餐（義大利+日本風）</li>
                        </ul>
                        <p class="accommodation">住宿：二世谷<br>24-2 Kabayama Kutchan-cho, 俱知安, 044-0078, 日本</p>
                    </details>
                </div>

                <!-- Day 6 -->
                <div class="day-card" data-lat="43.0618" data-lng="141.3545">
                    <h3>Day 6｜1月15日 前往札幌 & 市區探索</h3>
                    <p>移動札幌 + 下午市區散步</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>09:00-12:30：二世谷 → 札幌（預留3.5小時）</li>
                            <li>下午：大通公園雪景、時計台、舊北海道廳</li>
                            <li>19:30：爐端燒晚餐</li>
                        </ul>
                        <p class="restaurant">爐端燒地址：北海道札幌市中央区南６条西４プラザ6・4ビルB1F</p>
                        <p class="accommodation">住宿：SAPPORO HOTEL by GRANBELL<br>（札幌市中心）</p>
                    </details>
                </div>

                <!-- Day 7 -->
                <div class="day-card" data-lat="43.0618" data-lng="141.3545">
                    <h3>Day 7｜1月16日 札幌全天 & 返程準備</h3>
                    <p>札幌市內經典景點 + 夜景</p>
                    <details>
                        <summary>點擊查看詳細時間 & 景點</summary>
                        <ul>
                            <li>上午：札幌啤酒博物館、白い恋人公園</li>
                            <li>下午：薄野購物、雪燈光散步</li>
                            <li>晚上：藻岩山纜車夜景（全團推薦）</li>
                            <li>19:30：蟹料理晚餐</li>
                        </ul>
                        <p class="restaurant">蟹料理地址：地鐵大通站35號出口步行3分鐘，距離狸小路 302 米</p>
                        <p class="accommodation">住宿：SAPPORO HOTEL by GRANBELL<br>（札幌市中心）</p>
                    </details>
                </div>
            </div>
        </div>

        <div class="map-section">
            <h2>互動地圖（拖拽行程後自動優化動線）</h2>
            <div id="map"></div>
        </div>
    </div>

    <div class="container budget">
        <h2>預算估算模組（人均日圓，約值）</h2>
        <p>租車+油費（11人分攤）：<input type="number" id="car" value="3000"> /天</p>
        <p>住宿（Airbnb/酒店）：<input type="number" id="hotel" value="8000"> /天</p>
        <p>餐食平均：<input type="number" id="food" value="5000"> /天</p>
        <p>門票/滑雪/活動：<input type="number" id="ticket" value="6000"> /天</p>
        <p><strong>總估算（7天）：</strong> <span id="total">約 ¥147,000</span></p>
        <p class="note">實際依選擇變動，滑雪日活動費較高。</p>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
    <script>
        // 地圖初始化
        const map = L.map('map').setView([43.0, 141.5], 8);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        let routingControl = null;
        let markers = [];

        function updateMap() {
            if (routingControl) map.removeControl(routingControl);
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            const waypoints = [];
            document.querySelectorAll('.day-card').forEach(card => {
                const lat = parseFloat(card.dataset.lat);
                const lng = parseFloat(card.dataset.lng);
                const title = card.querySelector('h3').textContent;
                waypoints.push(L.latLng(lat, lng));
                const marker = L.marker([lat, lng]).addTo(map).bindPopup(title);
                markers.push(marker);
            });

            if (waypoints.length > 1) {
                routingControl = L.Routing.control({
                    waypoints: waypoints,
                    routeWhileDragging: true,
                    addWaypoints: false,
                    createMarker: () => null
                }).addTo(map);
            }
        }

        // 拖拽排序
        new Sortable(document.getElementById('days-list'), {
            animation: 150,
            onEnd: updateMap
        });

        // 初始載入
        updateMap();

        // 預算計算
        function calcBudget() {
            const car = parseInt(document.getElementById('car').value) || 0;
            const hotel = parseInt(document.getElementById('hotel').value) || 0;
            const food = parseInt(document.getElementById('food').value) || 0;
            const ticket = parseInt(document.getElementById('ticket').value) || 0;
            const total = (car + hotel + food + ticket) * 7;
            document.getElementById('total').textContent = `約 ¥${total.toLocaleString()}`;
        }
        document.querySelectorAll('input').forEach(input => input.addEventListener('input', calcBudget));
        calcBudget();
    </script>
</body>
</html>